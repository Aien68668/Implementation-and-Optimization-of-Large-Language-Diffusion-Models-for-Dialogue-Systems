{"ast":null,"code":"import React,{useState,useEffect,useRef,useCallback}from'react';import'../styles/ConfidenceIndicator.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const ConfidenceIndicator=_ref=>{let{isVisible,onClose,position,onPositionChange}=_ref;const[isDragging,setIsDragging]=useState(false);const[dragOffset,setDragOffset]=useState({x:0,y:0});const[isClosing,setIsClosing]=useState(false);const indicatorRef=useRef(null);const confidenceLevels=[{level:0,color:'#666',label:'[MASK]'},{level:0.25,color:'rgb(191, 64, 0)',label:'低置信度'},{level:0.5,color:'rgb(128, 128, 0)',label:'中置信度'},{level:0.75,color:'rgb(64, 191, 0)',label:'高置信度'},{level:1.0,color:'rgb(0, 255, 0)',label:'确定'}];const handleMouseDown=e=>{if(e.target.closest('.close-button'))return;setIsDragging(true);const rect=indicatorRef.current.getBoundingClientRect();setDragOffset({x:e.clientX-rect.left,y:e.clientY-rect.top});e.preventDefault();document.body.style.userSelect='none';document.body.style.cursor='grabbing';document.body.classList.add('dragging-indicator');};const handleMouseMove=useCallback(e=>{if(!isDragging)return;const newX=e.clientX-dragOffset.x;const newY=e.clientY-dragOffset.y;const maxX=window.innerWidth-280;const maxY=window.innerHeight-300;const constrainedX=Math.max(0,Math.min(newX,maxX));const constrainedY=Math.max(0,Math.min(newY,maxY));onPositionChange({x:constrainedX,y:constrainedY});},[isDragging,dragOffset.x,dragOffset.y,onPositionChange]);const handleMouseUp=useCallback(()=>{setIsDragging(false);document.body.style.userSelect='';document.body.style.cursor='';document.body.classList.remove('dragging-indicator');},[]);const handleClose=()=>{setIsClosing(true);setTimeout(()=>{onClose();setIsClosing(false);},300);};useEffect(()=>{if(isDragging){document.addEventListener('mousemove',handleMouseMove);document.addEventListener('mouseup',handleMouseUp);return()=>{document.removeEventListener('mousemove',handleMouseMove);document.removeEventListener('mouseup',handleMouseUp);};}},[isDragging,handleMouseMove,handleMouseUp]);useEffect(()=>{return()=>{document.body.style.userSelect='';document.body.style.cursor='';};},[]);if(!isVisible&&!isClosing)return null;return/*#__PURE__*/_jsxs(\"div\",{ref:indicatorRef,className:`confidence-indicator ${isDragging?'dragging':''} ${isClosing?'closing':''}`,style:{left:position.x,top:position.y,cursor:isDragging?'grabbing':'grab'},onMouseDown:handleMouseDown,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"indicator-header\",children:[/*#__PURE__*/_jsx(\"h4\",{children:\"\\u7F6E\\u4FE1\\u5EA6\\u6307\\u793A\\u5668\"}),/*#__PURE__*/_jsx(\"button\",{className:\"close-button\",onClick:handleClose,title:\"\\u5173\\u95ED\",children:\"\\xD7\"})]}),confidenceLevels.map((item,index)=>/*#__PURE__*/_jsxs(\"div\",{className:\"confidence-scale\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"color-box\",style:{backgroundColor:item.color}}),/*#__PURE__*/_jsx(\"span\",{children:item.label})]},index))]});};export default ConfidenceIndicator;","map":{"version":3,"names":["React","useState","useEffect","useRef","useCallback","jsx","_jsx","jsxs","_jsxs","ConfidenceIndicator","_ref","isVisible","onClose","position","onPositionChange","isDragging","setIsDragging","dragOffset","setDragOffset","x","y","isClosing","setIsClosing","indicatorRef","confidenceLevels","level","color","label","handleMouseDown","e","target","closest","rect","current","getBoundingClientRect","clientX","left","clientY","top","preventDefault","document","body","style","userSelect","cursor","classList","add","handleMouseMove","newX","newY","maxX","window","innerWidth","maxY","innerHeight","constrainedX","Math","max","min","constrainedY","handleMouseUp","remove","handleClose","setTimeout","addEventListener","removeEventListener","ref","className","onMouseDown","children","onClick","title","map","item","index","backgroundColor"],"sources":["/root/LLaDA-main/lldm/src/components/ConfidenceIndicator.js"],"sourcesContent":["import React, { useState, useEffect, useRef, useCallback } from 'react';\nimport '../styles/ConfidenceIndicator.css';\n\nconst ConfidenceIndicator = ({ isVisible, onClose, position, onPositionChange }) => {\n  const [isDragging, setIsDragging] = useState(false);\n  const [dragOffset, setDragOffset] = useState({ x: 0, y: 0 });\n  const [isClosing, setIsClosing] = useState(false);\n  const indicatorRef = useRef(null);\n\n  const confidenceLevels = [\n    { level: 0, color: '#666', label: '[MASK]' },\n    { level: 0.25, color: 'rgb(191, 64, 0)', label: '低置信度' },\n    { level: 0.5, color: 'rgb(128, 128, 0)', label: '中置信度' },\n    { level: 0.75, color: 'rgb(64, 191, 0)', label: '高置信度' },\n    { level: 1.0, color: 'rgb(0, 255, 0)', label: '确定' }\n  ];\n\n  const handleMouseDown = (e) => {\n    if (e.target.closest('.close-button')) return;\n    \n    setIsDragging(true);\n    const rect = indicatorRef.current.getBoundingClientRect();\n    setDragOffset({\n      x: e.clientX - rect.left,\n      y: e.clientY - rect.top\n    });\n    e.preventDefault();\n    \n    document.body.style.userSelect = 'none';\n    document.body.style.cursor = 'grabbing';\n    document.body.classList.add('dragging-indicator');\n  };\n\n  const handleMouseMove = useCallback((e) => {\n    if (!isDragging) return;\n    \n    const newX = e.clientX - dragOffset.x;\n    const newY = e.clientY - dragOffset.y;\n    \n    const maxX = window.innerWidth - 280;\n    const maxY = window.innerHeight - 300;\n    \n    const constrainedX = Math.max(0, Math.min(newX, maxX));\n    const constrainedY = Math.max(0, Math.min(newY, maxY));\n    \n    onPositionChange({\n      x: constrainedX,\n      y: constrainedY\n    });\n  }, [isDragging, dragOffset.x, dragOffset.y, onPositionChange]);\n\n  const handleMouseUp = useCallback(() => {\n    setIsDragging(false);\n    document.body.style.userSelect = '';\n    document.body.style.cursor = '';\n    document.body.classList.remove('dragging-indicator');\n  }, []);\n\n  const handleClose = () => {\n    setIsClosing(true);\n    setTimeout(() => {\n      onClose();\n      setIsClosing(false);\n    }, 300);\n  };\n\n  useEffect(() => {\n    if (isDragging) {\n      document.addEventListener('mousemove', handleMouseMove);\n      document.addEventListener('mouseup', handleMouseUp);\n      return () => {\n        document.removeEventListener('mousemove', handleMouseMove);\n        document.removeEventListener('mouseup', handleMouseUp);\n      };\n    }\n  }, [isDragging, handleMouseMove, handleMouseUp]);\n\n  useEffect(() => {\n    return () => {\n      document.body.style.userSelect = '';\n      document.body.style.cursor = '';\n    };\n  }, []);\n\n  if (!isVisible && !isClosing) return null;\n\n  return (\n    <div \n      ref={indicatorRef}\n      className={`confidence-indicator ${isDragging ? 'dragging' : ''} ${isClosing ? 'closing' : ''}`}\n      style={{\n        left: position.x,\n        top: position.y,\n        cursor: isDragging ? 'grabbing' : 'grab'\n      }}\n      onMouseDown={handleMouseDown}\n    >\n      <div className=\"indicator-header\">\n        <h4>置信度指示器</h4>\n        <button \n          className=\"close-button\"\n          onClick={handleClose}\n          title=\"关闭\"\n        >\n          ×\n        </button>\n      </div>\n      {confidenceLevels.map((item, index) => (\n        <div key={index} className=\"confidence-scale\">\n          <div \n            className=\"color-box\" \n            style={{ backgroundColor: item.color }}\n          ></div>\n          <span>{item.label}</span>\n        </div>\n      ))}\n    </div>\n  );\n};\n\nexport default ConfidenceIndicator;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}